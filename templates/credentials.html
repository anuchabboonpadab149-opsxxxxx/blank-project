<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>Credentials — จัสมินชอบกินแซลมอน</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans', 'Helvetica Neue', Arial, 'Noto Color Emoji', 'Noto Emoji', sans-serif; margin:0; padding:0; background:#111; color:#eee; }
    a { color:#85d0ff; text-decoration:none; }
    header { padding: 16px 24px; background:#181818; border-bottom:1px solid #2a2a2a; display:flex; align-items:center; gap: 16px; }
    h1 { margin:0; font-size:20px; }
    .wrap { padding: 16px 24px; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
    .panel { background:#181818; border:1px solid #2a2a2a; border-radius:10px; padding:12px; }
    label { display:block; font-size:12px; color:#bbb; margin-top:8px; }
    input[type="text"], input[type="password"] { width:100%; background:#121212; border:1px solid #2a2a2a; color:#eaeaea; border-radius:6px; padding:6px 8px; }
    .btn { display:inline-block; background:#2a6bff; color:#fff; border:0; padding:8px 14px; border-radius:6px; cursor:pointer; margin-top:12px; }
    .small { color:#aaa; font-size:12px; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    @media (max-width: 1024px) { .grid { grid-template-columns: 1fr; } .row { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <header>
    <h1>Credentials — จัสมินชอบกินแซลมอน</h1>
    <a href="/">กลับสู่แดชบอร์ด</a>
  </header>

  <div class="wrap">
    <div class="small">คำแนะนำ: ช่องที่มีค่าอยู่แล้ว จะแสดงค่าแบบซ่อนในเครื่องหมาย [stored]. ปลอดภัย: ระบบจะไม่แสดงค่าเต็มบนหน้าเว็บ</div>
    <div id="msg" class="small" style="margin:8px 0 16px 0; color:#9ad;"></div>

    <div class="grid">
      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Twitter (X)</div>
        <label>TW_CONSUMER_KEY <span class="small" id="s_TW_CONSUMER_KEY"></span></label>
        <input id="TW_CONSUMER_KEY" type="password" placeholder="..." />
        <label>TW_CONSUMER_SECRET <span class="small" id="s_TW_CONSUMER_SECRET"></span></label>
        <input id="TW_CONSUMER_SECRET" type="password" placeholder="..." />
        <label>TW_ACCESS_TOKEN <span class="small" id="s_TW_ACCESS_TOKEN"></span></label>
        <input id="TW_ACCESS_TOKEN" type="password" placeholder="..." />
        <label>TW_ACCESS_TOKEN_SECRET <span class="small" id="s_TW_ACCESS_TOKEN_SECRET"></span></label>
        <input id="TW_ACCESS_TOKEN_SECRET" type="password" placeholder="..." />
        <label>TW_BEARER_TOKEN (metrics) <span class="small" id="s_TW_BEARER_TOKEN"></span></label>
        <input id="TW_BEARER_TOKEN" type="password" placeholder="..." />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Facebook / Instagram</div>
        <label>FB_PAGE_ID <span class="small" id="s_FB_PAGE_ID"></span></label>
        <input id="FB_PAGE_ID" type="text" placeholder="..." />
        <label>FB_ACCESS_TOKEN <span class="small" id="s_FB_ACCESS_TOKEN"></span></label>
        <input id="FB_ACCESS_TOKEN" type="password" placeholder="..." />
        <label>IG_USER_ID <span class="small" id="s_IG_USER_ID"></span></label>
        <input id="IG_USER_ID" type="text" placeholder="..." />
        <label>IG_IMAGE_URL (required by IG) <span class="small" id="s_IG_IMAGE_URL"></span></label>
        <input id="IG_IMAGE_URL" type="text" placeholder="https://..." />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">LinkedIn</div>
        <label>LI_ACCESS_TOKEN <span class="small" id="s_LI_ACCESS_TOKEN"></span></label>
        <input id="LI_ACCESS_TOKEN" type="password" placeholder="..." />
        <label>LI_ORG_URN <span class="small" id="s_LI_ORG_URN"></span></label>
        <input id="LI_ORG_URN" type="text" placeholder="urn:li:organization:XXXX" />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">LINE</div>
        <label>LINE_CHANNEL_ACCESS_TOKEN <span class="small" id="s_LINE_CHANNEL_ACCESS_TOKEN"></span></label>
        <input id="LINE_CHANNEL_ACCESS_TOKEN" type="password" placeholder="..." />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Telegram</div>
        <label>TELEGRAM_BOT_TOKEN <span class="small" id="s_TELEGRAM_BOT_TOKEN"></span></label>
        <input id="TELEGRAM_BOT_TOKEN" type="password" placeholder="..." />
        <label>TELEGRAM_CHAT_ID <span class="small" id="s_TELEGRAM_CHAT_ID"></span></label>
        <input id="TELEGRAM_CHAT_ID" type="text" placeholder="@yourchannel or numeric chat id" />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Discord</div>
        <label>DISCORD_WEBHOOK_URL <span class="small" id="s_DISCORD_WEBHOOK_URL"></span></label>
        <input id="DISCORD_WEBHOOK_URL" type="text" placeholder="https://discord.com/api/webhooks/..." />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Reddit</div>
        <label>REDDIT_CLIENT_ID <span class="small" id="s_REDDIT_CLIENT_ID"></span></label>
        <input id="REDDIT_CLIENT_ID" type="text" placeholder="..." />
        <label>REDDIT_CLIENT_SECRET <span class="small" id="s_REDDIT_CLIENT_SECRET"></span></label>
        <input id="REDDIT_CLIENT_SECRET" type="password" placeholder="..." />
        <div class="row">
          <div>
            <label>REDDIT_USERNAME <span class="small" id="s_REDDIT_USERNAME"></span></label>
            <input id="REDDIT_USERNAME" type="text" placeholder="..." />
          </div>
          <div>
            <label>REDDIT_PASSWORD <span class="small" id="s_REDDIT_PASSWORD"></span></label>
            <input id="REDDIT_PASSWORD" type="password" placeholder="..." />
          </div>
        </div>
        <label>REDDIT_SUBREDDIT <span class="small" id="s_REDDIT_SUBREDDIT"></span></label>
        <input id="REDDIT_SUBREDDIT" type="text" placeholder="mysubreddit" />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Mastodon</div>
        <label>MASTODON_BASE_URL <span class="small" id="s_MASTODON_BASE_URL"></span></label>
        <input id="MASTODON_BASE_URL" type="text" placeholder="https://mastodon.social" />
        <label>MASTODON_ACCESS_TOKEN <span class="small" id="s_MASTODON_ACCESS_TOKEN"></span></label>
        <input id="MASTODON_ACCESS_TOKEN" type="password" placeholder="..." />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">TikTok Business (Ads placeholder)</div>
        <label>TIKTOK_APP_ID <span class="small" id="s_TIKTOK_APP_ID"></span></label>
        <input id="TIKTOK_APP_ID" type="text" placeholder="..." />
        <label>TIKTOK_SECRET <span class="small" id="s_TIKTOK_SECRET"></span></label>
        <input id="TIKTOK_SECRET" type="password" placeholder="..." />
        <label>TIKTOK_ADVERTISER_ID <span class="small" id="s_TIKTOK_ADVERTISER_ID"></span></label>
        <input id="TIKTOK_ADVERTISER_ID" type="text" placeholder="..." />
      </div>

      <div class="panel">
        <div style="font-weight:600; margin-bottom:6px;">Twitter Ads</div>
        <label>ADS_ACCOUNT_ID <span class="small" id="s_ADS_ACCOUNT_ID"></span></label>
        <input id="ADS_ACCOUNT_ID" type="text" placeholder="..." />
        <label>FUNDING_INSTRUMENT_ID <span class="small" id="s_FUNDING_INSTRUMENT_ID"></span></label>
        <input id="FUNDING_INSTRUMENT_ID" type="text" placeholder="..." />
        <label>CAMPAIGN_ID (optional) <span class="small" id="s_CAMPAIGN_ID"></span></label>
        <input id="CAMPAIGN_ID" type="text" placeholder="..." />
        <label>LINE_ITEM_ID (optional) <span class="small" id="s_LINE_ITEM_ID"></span></label>
        <input id="LINE_ITEM_ID" type="text" placeholder="..." />
        <label>ADS_ENTITY_IDS (analytics; comma-separated) <span class="small" id="s_ADS_ENTITY_IDS"></span></label>
        <input id="ADS_ENTITY_IDS" type="text" placeholder="id1,id2,..." />
      </div>
    </div>

    <button class="btn" id="save">Save credentials</button>
  </div>

  <script>
    const msg = document.getElementById('msg');

    const KEYS = [
      "TW_CONSUMER_KEY","TW_CONSUMER_SECRET","TW_ACCESS_TOKEN","TW_ACCESS_TOKEN_SECRET","TW_BEARER_TOKEN",
      "FB_PAGE_ID","FB_ACCESS_TOKEN","IG_USER_ID","IG_IMAGE_URL",
      "LI_ACCESS_TOKEN","LI_ORG_URN",
      "LINE_CHANNEL_ACCESS_TOKEN",
      "TELEGRAM_BOT_TOKEN","TELEGRAM_CHAT_ID",
      "DISCORD_WEBHOOK_URL",
      "REDDIT_CLIENT_ID","REDDIT_CLIENT_SECRET","REDDIT_USERNAME","REDDIT_PASSWORD","REDDIT_SUBREDDIT",
      "MASTODON_BASE_URL","MASTODON_ACCESS_TOKEN",
      "TIKTOK_APP_ID","TIKTOK_SECRET","TIKTOK_ADVERTISER_ID",
      "ADS_ACCOUNT_ID","FUNDING_INSTRUMENT_ID","CAMPAIGN_ID","LINE_ITEM_ID",
      "ADS_ENTITY_IDS"
    ];

    async function loadMasked() {
      try {
        const r = await fetch('/api/credentials');
        const data = await r.json();
        for (const k of KEYS) {
          const span = document.getElementById('s_' + k);
          if (span) {
            if (data[k]) {
              span.textContent = `[stored: ${data[k]}]`;
            } else {
              span.textContent = '';
            }
          }
        }
      } catch (e) {}
    }

    document.getElementById('save').onclick = async () => {
      const payload = {};
      for (const k of KEYS) {
        const el = document.getElementById(k);
        if (!el) continue;
        const val = el.value.trim();
        if (val !== "") {
          payload[k] = val;
        }
      }
      const r = await fetch('/api/credentials', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      const data = await r.json();
      if (data.ok) {
        msg.textContent = 'Saved and applied. Providers will use new credentials on next cycle.';
        // Clear inputs after save
        for (const k of KEYS) {
          const el = document.getElementById(k);
          if (el) el.value = '';
        }
        loadMasked();
      } else {
        msg.textContent = 'Error: ' + (data.error || 'unknown');
      }
      setTimeout(() => msg.textContent = '', 2500);
    };

    loadMasked();
  </script>
</body>
</html>